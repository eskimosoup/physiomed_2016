.what-we-do-usps {
  @include flex-grid-row(null, expand);
  border-bottom: 7px solid $color--black-offset;

  &__title {
    font-size: rem(17px);
    font-weight: $font--open-sans--extrabold;
    text-transform: none;

    @include breakpoint(medium down) {
      text-align: center;
      margin-bottom: 0;
      margin-top: rem(45px);
    }

    @include breakpoint(large) {
      margin-bottom: rem(35px);
      margin-left: rem(15px);
      margin-top: rem(45px);
    }

    @include breakpoint(xlarge) {
      margin-bottom: rem(50px);
      margin-top: rem(60px);
    }
  }

  &__introduction {
    font-size: rem(17px);
    font-weight: $font--open-sans--bold;
    text-align: center;

    @include breakpoint(large) {
      display: inline-block;
      width: calc(100% - 160px);
    }
  }

  &__content {
    position: relative;

    @include breakpoint(medium down) {
      padding-bottom: rem(35px);
    }

    @include breakpoint(large) {
      padding-bottom: rem(45px);
    }

    @include breakpoint(xlarge) {
      padding-bottom: rem(60px);
    }

    &:not(:last-of-type)::after {
      position: absolute;

      @include breakpoint(medium down) {
        content: ' ';
        bottom: -23px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 100;
      }

      @include breakpoint(large) {
        content: ' ';
        right: -19px;
        top: rem(57px);
        z-index: 100;
      }

      @include breakpoint(xlarge) {
        top: rem(44px);
      }
    }

    &--expanded {
      @include breakpoint(medium down) {
        @include flex-grid-column(12);
      }

      @include breakpoint(large) {
        @include flex-grid-column(6, (xlarge: 60));

        .what-we-do-usps__title {
          display: inline-block;
          margin-right: rem(35px);
        }
      }
    }

    &--green {
      color: $color--white;

      @include breakpoint(medium down) {
        background: $color--green;
      }

      @include breakpoint(large) {
        background: linear-gradient(to bottom, $color--green 0%, $color--green 25%, $color--green 30%, rgba($color--green, 0) 100%),
                    image-url('layout/what-we-do/what.png') no-repeat bottom center,
                    $color--green;
      }


      &::after {
        @include breakpoint(medium down) {
          @include triangle-large('down', $color--green, 24px);
        }

        @include breakpoint(large) {
          @include triangle-large('right', $color--green, 24px);
        }
      }
    }

    &--clinical-grey {
      background-color: $color--clinical-grey;
      color: $color--brown--light;

      &::after {
        @include breakpoint(medium down) {
          @include triangle-large('down', $color--clinical-grey, 24px);
        }

        @include breakpoint(large) {
          @include triangle-large('right', $color--clinical-grey, 24px);
        }
      }
    }

    &--brown-light {
      color: $color--white;

      @include breakpoint(medium down) {
        background: $color--brown--light;
      }

      @include breakpoint(large) {
        background: linear-gradient(to bottom, $color--brown--light 0%, $color--brown--light 25%, $color--brown--light 30%, rgba($color--brown--light, 0) 100%),
                    image-url('layout/what-we-do/why.png') no-repeat bottom center,
                    $color--brown--light;
      }

      &::after {
        @include breakpoint(medium down) {
          @include triangle-large('down', $color--brown--light, 24px);
        }

        @include breakpoint(large) {
          @include triangle-large('right', $color--brown--light, 24px);
        }
      }
    }

    &--orange {
      color: $color--white;

      @include breakpoint(medium down) {
        background: $color--orange;
      }

      @include breakpoint(large) {
        background: linear-gradient(to bottom, $color--orange 0%, $color--orange 25%, $color--orange 30%, rgba($color--orange, 0) 100%),
                    image-url('layout/what-we-do/benefits.png') no-repeat bottom center,
                    $color--orange;
      }
    }

    &:not(&--expanded) {
      @include breakpoint(medium down) {
        @include flex-grid-column(12);
      }

      @include breakpoint(large) {
        @include flex-grid-column(2, (xlarge: 50));
      }
    }
  }

  &__link {
    color: $color--white;
  }
}

.what-we-do-usps-list {
  font-weight: $font--open-sans--semibold;
  list-style-position: outside;
  margin: rem(0 0 0 15px);

  @include breakpoint(medium down) {
    display: none;
  }

  &__item {
    margin-bottom: rem(5px);
  }
}

.what-we-do-supports {
  @include flex-grid-row;
  margin-top: rem(30px);

  &__inner {
    @include flex-grid-column(12);
  }

  &__content {
    @include generic-service-box-shadow;
    background-color: $color--white;
    border-bottom: 6px solid $color--black-offset;
    border-top: 6px solid $color--black-offset;
    font-size: rem(17px);
    padding: rem(15px 25px);
    position: relative;
    text-align: center;
    z-index: 2;

    &::before {
      background-color: $color--black-offset;
      content: ' ';
      height: 40px;
      left: 50%;
      position: absolute;
      top: -40px;
      transform: translateX(-50%);
      width: 7px;
      z-index: 1;
    }
  }
}

.what-we-do-supports-technique {
  @include flex-grid-row;
  align-items: center;
  justify-content: center;
  list-style: none;

  &__item {
    @include responsive-flex-grid-column((medium down: 12, large: 4));
  }

  &__inner {
    align-items: center;
    background-position: center left;
    background-repeat: no-repeat;
    color: $color--green;
    display: flex;
    font-size: rem(17px);
    font-weight: $font--open-sans--semibold;
    min-height: 64px;

    @include breakpoint(medium down) {
      background-size: 40px;
    }

    &--secure-online-portal {
      background-image: image-url('layout/what-we-do/icons/secure-online-portal.png');
      padding-left: rem(100px);
    }

    &--clinical-governance {
      background-image: image-url('layout/what-we-do/icons/clinical-governance.png');
      padding-left: rem(100px);
    }

    &--management-information {
      background-image: image-url('layout/what-we-do/icons/management-information.png');
      padding-left: rem(100px);

      @include breakpoint(medium down) {
        padding-left: rem(70px);
      }
    }
  }
}

.service-categories-top-level-usps {
  font-size: 0;
  list-style: none;
  margin: 0 auto;
  max-width: 98%;

  &__item {
    display: inline-block;
    font-size: rem(17px);
    width: 25%;

    &:last-of-type {
      .service-categories-top-level-usps__link::after {
        display: none;
      }
    }
  }

  &__link {
    display: block;
    padding: rem(12px);
    position: relative;
    width: 100%;

    &::after {
      position: absolute;

      @include breakpoint(medium down) {
        content: ' ';
        bottom: -23px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 100;
      }

      @include breakpoint(large) {
        content: ' ';
        right: -24px;
        top: 1px;
        z-index: 100;
      }

      @include breakpoint(xlarge) {
        top: 1px;
      }
    }

    &--green {
      background: $color--green;
      color: $color--white;


      &::after {
        @include breakpoint(medium down) {
          @include triangle-large('down', $color--green, 24px);
        }

        @include breakpoint(large) {
          @include triangle-large('right', $color--green, 24px);
        }
      }
    }

    &--clinical-grey {
      background-color: $color--clinical-grey;
      color: $color--brown--light;

      &::after {
        @include breakpoint(medium down) {
          @include triangle-large('down', $color--clinical-grey, 24px);
        }

        @include breakpoint(large) {
          @include triangle-large('right', $color--clinical-grey, 24px);
        }
      }
    }

    &--brown-light {
      background: $color--brown--light;
      color: $color--white;

      &::after {
        @include breakpoint(medium down) {
          @include triangle-large('down', $color--brown--light, 24px);
        }

        @include breakpoint(large) {
          @include triangle-large('right', $color--brown--light, 24px);
        }
      }
    }

    &--orange {
      background: $color--orange;
      color: $color--white;


      &::after {
        @include breakpoint(medium down) {
          @include triangle-large('down', $color--orange, 24px);
        }

        @include breakpoint(large) {
          @include triangle-large('right', $color--orange, 24px);
        }
      }
    }
  }
}
